# %%
#Importamos las librerias necesarias
from pandas import concat
import requests
import urllib.request
import urllib.parse
from datetime import date
import json
import os

# %%
#Creamos una lista con las sucursales y los barrios/zonas correspondientes
print("Obteniendo sucursales")
Sucursales = [
#    {"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=1-1-7,10-1-1,10-1-10,10-1-11,10-1-112,10-1-12,10-1-123,10-1-128,10-1-136,10-1-139,10-1-142,10-1-147,10-1-149,10-1-15,10-1-156,10-1-157,10-1-159,10-1-16,10-1-161,10-1-162,10-1-17,10-1-171,10-1-175,10-1-178,10-1-179,10-1-18,10-1-180,10-1-183,10-1-2,10-1-204"},
    
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=1-1-7,10-1-1,10-1-10,10-1-11,10-1-112,10-1-12,10-1-123,10-1-128,10-1-136,10-1-139,10-1-142,10-1-147,10-1-149,10-1-15,10-1-156,10-1-157,10-1-159,10-1-16,10-1-161,10-1-162,10-1-17,10-1-171,10-1-175,10-1-178,10-1-179,10-1-18,10-1-180,10-1-183,10-1-2,10-1-204"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-1-21,10-1-210,10-1-214,10-1-217,10-1-219,10-1-22,10-1-220,10-1-227,10-1-229,10-1-23,10-1-231,10-1-232,10-1-233,10-1-234,10-1-235,10-1-239,10-1-24,10-1-240,10-1-241,10-1-25,10-1-259,10-1-26,10-1-268,10-1-271,10-1-28,10-1-29,10-1-292,10-1-294,10-1-297,10-1-30"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-1-31,10-1-32,10-1-33,10-1-36,10-1-40,10-1-41,10-1-42,10-1-43,10-1-44,10-1-45,10-1-46,10-1-47,10-1-48,10-1-49,10-1-5,10-1-50,10-1-51,10-1-52,10-1-53,10-1-54,10-1-55,10-1-56,10-1-57,10-1-58,10-1-6,10-1-63,10-1-7,10-1-8,10-1-9,10-2-101"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-2-109,10-2-110,10-2-114,10-2-115,10-2-116,10-2-118,10-2-119,10-2-120,10-2-122,10-2-125,10-2-130,10-2-132,10-2-134,10-2-135,10-2-137,10-2-138,10-2-141,10-2-143,10-2-144,10-2-146,10-2-148,10-2-150,10-2-151,10-2-154,10-2-165,10-2-167,10-2-168,10-2-176,10-2-177,10-2-181"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-2-182,10-2-184,10-2-187,10-2-189,10-2-191,10-2-195,10-2-198,10-2-201,10-2-202,10-2-203,10-2-205,10-2-206,10-2-208,10-2-209,10-2-211,10-2-212,10-2-215,10-2-216,10-2-218,10-2-221,10-2-226,10-2-228,10-2-237,10-2-243,10-2-244,10-2-249,10-2-252,10-2-253,10-2-254,10-2-255"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-2-256,10-2-258,10-2-262,10-2-263,10-2-264,10-2-266,10-2-272,10-2-277,10-2-278,10-2-282,10-2-283,10-2-285,10-2-286,10-2-287,10-2-288,10-2-289,10-2-290,10-2-293,10-2-295,10-2-296,10-2-381,10-2-384,10-2-385,10-2-386,10-2-387,10-2-388,10-2-389,10-2-390,10-2-490,10-2-491"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-2-510,10-2-511,10-2-512,10-2-514,10-2-515,10-2-516,10-2-517,10-2-518,10-2-519,10-2-601,10-2-62,10-3-196,10-3-199,10-3-200,10-3-213,10-3-242,10-3-247,10-3-250,10-3-251,10-3-260,10-3-265,10-3-291,10-3-298,10-3-299,10-3-300,10-3-301,10-3-302,10-3-303,10-3-304,10-3-306"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-3-307,10-3-308,10-3-309,10-3-310,10-3-311,10-3-312,10-3-313,10-3-314,10-3-315,10-3-316,10-3-317,10-3-318,10-3-320,10-3-321,10-3-322,10-3-323,10-3-324,10-3-325,10-3-326,10-3-327,10-3-328,10-3-329,10-3-330,10-3-331,10-3-332,10-3-334,10-3-335,10-3-336,10-3-337,10-3-338"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-3-339,10-3-340,10-3-341,10-3-343,10-3-344,10-3-345,10-3-346,10-3-347,10-3-348,10-3-349,10-3-350,10-3-351,10-3-352,10-3-353,10-3-354,10-3-355,10-3-356,10-3-357,10-3-360,10-3-361,10-3-362,10-3-363,10-3-364,10-3-365,10-3-367,10-3-368,10-3-369,10-3-370,10-3-371,10-3-373"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-3-374,10-3-375,10-3-376,10-3-378,10-3-379,10-3-380,10-3-391,10-3-392,10-3-394,10-3-395,10-3-396,10-3-397,10-3-398,10-3-400,10-3-402,10-3-403,10-3-404,10-3-405,10-3-406,10-3-408,10-3-409,10-3-410,10-3-411,10-3-412,10-3-413,10-3-414,10-3-415,10-3-416,10-3-417,10-3-418"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-3-419,10-3-420,10-3-421,10-3-422,10-3-423,10-3-424,10-3-425,10-3-426,10-3-427,10-3-428,10-3-429,10-3-430,10-3-431,10-3-433,10-3-435,10-3-436,10-3-437,10-3-438,10-3-439,10-3-440,10-3-441,10-3-442,10-3-443,10-3-444,10-3-445,10-3-446,10-3-447,10-3-448,10-3-449,10-3-450"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-3-451,10-3-452,10-3-453,10-3-454,10-3-455,10-3-456,10-3-457,10-3-458,10-3-459,10-3-460,10-3-461,10-3-462,10-3-463,10-3-464,10-3-465,10-3-466,10-3-467,10-3-468,10-3-469,10-3-470,10-3-471,10-3-472,10-3-473,10-3-474,10-3-475,10-3-476,10-3-477,10-3-478,10-3-479,10-3-480"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-3-481,10-3-482,10-3-483,10-3-484,10-3-485,10-3-486,10-3-487,10-3-488,10-3-489,10-3-492,10-3-493,10-3-494,10-3-495,10-3-496,10-3-497,10-3-498,10-3-499,10-3-521,10-3-522,10-3-524,10-3-525,10-3-526,10-3-527,10-3-528,10-3-529,10-3-530,10-3-531,10-3-532,10-3-533,10-3-534"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-3-535,10-3-536,10-3-537,10-3-538,10-3-539,10-3-540,10-3-541,10-3-542,10-3-543,10-3-544,10-3-545,10-3-546,10-3-547,10-3-548,10-3-549,10-3-550,10-3-551,10-3-552,10-3-553,10-3-554,10-3-555,10-3-556,10-3-557,10-3-558,10-3-559,10-3-560,10-3-561,10-3-562,10-3-563,10-3-565"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-3-566,10-3-568,10-3-569,10-3-570,10-3-571,10-3-572,10-3-573,10-3-574,10-3-575,10-3-576,10-3-577,10-3-578,10-3-579,10-3-580,10-3-581,10-3-582,10-3-583,10-3-584,10-3-585,10-3-586,10-3-587,10-3-588,10-3-589,10-3-590,10-3-591,10-3-592,10-3-593,10-3-594,10-3-595,10-3-596"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-3-597,10-3-598,10-3-599,10-3-600,10-3-602,10-3-604,10-3-605,10-3-606,10-3-607,10-3-608,10-3-609,10-3-610,10-3-613,10-3-614,10-3-615,10-3-616,10-3-617,10-3-618,10-3-619,10-3-620,10-3-621,10-3-622,10-3-623,10-3-624,10-3-625,10-3-626,10-3-627,10-3-628,10-3-630,10-3-631"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-3-632,10-3-633,10-3-634,10-3-635,10-3-636,10-3-638,10-3-639,10-3-640,10-3-641,10-3-642,10-3-643,10-3-644,10-3-645,10-3-646,10-3-648,10-3-649,10-3-650,10-3-652,10-3-654,10-3-655,10-3-656,10-3-657,10-3-658,10-3-659,10-3-660,10-3-661,10-3-662,10-3-663,10-3-664,10-3-665"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-3-667,10-3-668,10-3-669,10-3-670,10-3-671,10-3-672,10-3-673,10-3-674,10-3-675,10-3-676,10-3-677,10-3-678,10-3-679,10-3-680,10-3-682,10-3-683,10-3-684,10-3-685,10-3-686,10-3-687,10-3-688,10-3-689,10-3-691,10-3-693,10-3-694,10-3-695,10-3-697,10-3-698,10-3-699,10-3-710"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=10-3-711,10-3-715,10-3-716,10-3-721,10-3-723,10-3-724,10-3-725,10-3-726,10-3-727,10-3-730,10-3-731,10-3-732,10-3-733,10-3-734,10-3-735,10-3-739,10-3-740,10-3-742,11-2-1007,11-2-1011,11-2-1012,11-2-1013,11-2-1015,11-2-1021,11-2-1022,11-2-1023,11-2-1024,11-2-1026,11-2-1028,11-2-1029"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=11-2-1031,11-2-1032,11-2-1033,11-2-1035,11-2-1038,11-2-1039,11-2-1042,11-2-1050,11-2-1051,11-2-1052,11-2-1053,11-2-1055,11-2-1056,11-2-1059,11-2-1060,11-2-1061,11-2-1067,11-2-1074,11-2-1075,11-2-1076,11-2-1077,11-2-1078,11-2-1080,11-2-1081,11-2-1082,11-2-1085,11-2-1086,11-2-1088,11-2-1092,11-2-1097"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=11-2-1098,11-2-1099,11-2-1100,11-2-1106,11-2-1108,11-2-1110,11-2-1111,11-2-1114,11-2-1115,11-2-1116,11-4-1027,11-4-1030,11-4-1036,11-4-1037,11-4-1044,11-4-1045,11-4-1046,11-4-1084,11-5-1002,11-5-1003,11-5-1004,11-5-1005,11-5-1006,11-5-1008,11-5-1010,11-5-1014,11-5-1016,11-5-1017,11-5-1018,11-5-1020"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=11-5-1043,11-5-1054,11-5-1057,11-5-1058,11-5-1068,11-5-1087,11-5-1093,11-5-1096,11-5-2997,11-5-2998,11-5-2999,11-5-3601,11-5-3602,11-5-3603,11-5-3604,11-5-3605,11-5-3606,11-5-3608,11-5-3613,12-1-101,12-1-103,12-1-104,12-1-105,12-1-107,12-1-108,12-1-109,12-1-110,12-1-111,12-1-116,12-1-117"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=12-1-118,12-1-121,12-1-123,12-1-124,12-1-125,12-1-129,12-1-13,12-1-130,12-1-131,12-1-136,12-1-149,12-1-151,12-1-153,12-1-154,12-1-155,12-1-158,12-1-159,12-1-160,12-1-162,12-1-163,12-1-164,12-1-165,12-1-167,12-1-168,12-1-170,12-1-171,12-1-174,12-1-175,12-1-176,12-1-178"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=12-1-179,12-1-18,12-1-180,12-1-181,12-1-183,12-1-184,12-1-185,12-1-186,12-1-188,12-1-189,12-1-19,12-1-192,12-1-197,12-1-199,12-1-2,12-1-20,12-1-203,12-1-204,12-1-208,12-1-209,12-1-215,12-1-219,12-1-22,12-1-220,12-1-24,12-1-25,12-1-26,12-1-35,12-1-37,12-1-38"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=12-1-39,12-1-40,12-1-41,12-1-42,12-1-43,12-1-44,12-1-45,12-1-46,12-1-47,12-1-48,12-1-49,12-1-51,12-1-52,12-1-53,12-1-55,12-1-56,12-1-57,12-1-58,12-1-59,12-1-6,12-1-60,12-1-61,12-1-63,12-1-64,12-1-65,12-1-66,12-1-67,12-1-68,12-1-69,12-1-7"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=12-1-70,12-1-71,12-1-74,12-1-75,12-1-78,12-1-80,12-1-82,12-1-83,12-1-84,12-1-85,12-1-88,12-1-90,12-1-91,12-1-92,12-1-94,12-1-95,12-1-96,12-1-97,12-1-99,13-1-1,13-1-10,13-1-100,13-1-101,13-1-102,13-1-103,13-1-104,13-1-105,13-1-106,13-1-107,13-1-108"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=13-1-109,13-1-11,13-1-110,13-1-111,13-1-112,13-1-113,13-1-114,13-1-115,13-1-116,13-1-117,13-1-118,13-1-119,13-1-12,13-1-120,13-1-121,13-1-122,13-1-123,13-1-124,13-1-125,13-1-126,13-1-127,13-1-128,13-1-129,13-1-13,13-1-130,13-1-131,13-1-132,13-1-133,13-1-134,13-1-14"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=13-1-15,13-1-16,13-1-17,13-1-18,13-1-19,13-1-2,13-1-20,13-1-21,13-1-22,13-1-23,13-1-24,13-1-25,13-1-26,13-1-27,13-1-28,13-1-29,13-1-3,13-1-30,13-1-31,13-1-32,13-1-33,13-1-34,13-1-35,13-1-36,13-1-37,13-1-38,13-1-39,13-1-4,13-1-40,13-1-41"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=13-1-42,13-1-43,13-1-44,13-1-45,13-1-46,13-1-47,13-1-48,13-1-49,13-1-5,13-1-50,13-1-51,13-1-52,13-1-53,13-1-54,13-1-55,13-1-56,13-1-57,13-1-58,13-1-59,13-1-6,13-1-60,13-1-61,13-1-62,13-1-63,13-1-64,13-1-65,13-1-66,13-1-67,13-1-68,13-1-69"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=13-1-7,13-1-70,13-1-71,13-1-72,13-1-73,13-1-74,13-1-75,13-1-76,13-1-77,13-1-78,13-1-79,13-1-8,13-1-80,13-1-81,13-1-82,13-1-83,13-1-84,13-1-85,13-1-86,13-1-87,13-1-88,13-1-89,13-1-9,13-1-90,13-1-91,13-1-92,13-1-93,13-1-94,13-1-95,13-1-96"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=13-1-97,13-1-98,13-1-99,14-1-1,14-1-10,14-1-11,14-1-2,14-1-3,14-1-4,14-1-5,14-1-6,14-1-7,14-1-8,14-1-9,15-1-1,15-1-10,15-1-100,15-1-1002,15-1-1003,15-1-1004,15-1-1006,15-1-1007,15-1-1008,15-1-1009,15-1-101,15-1-1010,15-1-1011,15-1-1012,15-1-1014,15-1-1015"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-1017,15-1-1018,15-1-1019,15-1-102,15-1-1021,15-1-1022,15-1-1023,15-1-1024,15-1-1025,15-1-1026,15-1-1027,15-1-1028,15-1-1029,15-1-103,15-1-1030,15-1-1031,15-1-1032,15-1-1034,15-1-1035,15-1-1036,15-1-1037,15-1-1038,15-1-1039,15-1-104,15-1-1040,15-1-1041,15-1-1043,15-1-1044,15-1-1045,15-1-1046"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-1047,15-1-1048,15-1-1049,15-1-105,15-1-1050,15-1-1054,15-1-1055,15-1-1056,15-1-1057,15-1-1059,15-1-106,15-1-1060,15-1-1061,15-1-1062,15-1-1063,15-1-1064,15-1-1065,15-1-1066,15-1-1068,15-1-1069,15-1-107,15-1-1070,15-1-1071,15-1-1072,15-1-1073,15-1-1074,15-1-1075,15-1-1076,15-1-1077,15-1-1078"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-108,15-1-1080,15-1-1086,15-1-1088,15-1-109,15-1-1091,15-1-1092,15-1-1093,15-1-11,15-1-110,15-1-111,15-1-113,15-1-115,15-1-116,15-1-117,15-1-118,15-1-119,15-1-12,15-1-120,15-1-122,15-1-123,15-1-124,15-1-125,15-1-126,15-1-127,15-1-128,15-1-129,15-1-13,15-1-130,15-1-131"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-132,15-1-133,15-1-134,15-1-136,15-1-137,15-1-138,15-1-139,15-1-14,15-1-140,15-1-141,15-1-142,15-1-143,15-1-145,15-1-146,15-1-147,15-1-148,15-1-149,15-1-15,15-1-150,15-1-1501,15-1-1502,15-1-1503,15-1-1504,15-1-1505,15-1-1506,15-1-1507,15-1-1508,15-1-1509,15-1-151,15-1-1510"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-1511,15-1-1513,15-1-1514,15-1-1515,15-1-1516,15-1-1517,15-1-1518,15-1-152,15-1-1520,15-1-1521,15-1-1523,15-1-1524,15-1-1525,15-1-1527,15-1-1531,15-1-1532,15-1-1533,15-1-1534,15-1-1535,15-1-1536,15-1-1538,15-1-154,15-1-155,15-1-156,15-1-157,15-1-158,15-1-159,15-1-16,15-1-160,15-1-161"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-162,15-1-163,15-1-164,15-1-165,15-1-168,15-1-169,15-1-170,15-1-171,15-1-172,15-1-174,15-1-176,15-1-177,15-1-179,15-1-180,15-1-1800,15-1-1801,15-1-1802,15-1-1803,15-1-182,15-1-183,15-1-184,15-1-185,15-1-186,15-1-187,15-1-189,15-1-19,15-1-190,15-1-194,15-1-197,15-1-198"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-199,15-1-2,15-1-20,15-1-201,15-1-202,15-1-203,15-1-204,15-1-205,15-1-206,15-1-207,15-1-208,15-1-209,15-1-21,15-1-210,15-1-211,15-1-212,15-1-213,15-1-214,15-1-216,15-1-217,15-1-218,15-1-219,15-1-220,15-1-222,15-1-223,15-1-224,15-1-225,15-1-226,15-1-228,15-1-23"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-230,15-1-231,15-1-233,15-1-234,15-1-237,15-1-238,15-1-239,15-1-24,15-1-240,15-1-241,15-1-242,15-1-243,15-1-244,15-1-245,15-1-248,15-1-25,15-1-250,15-1-251,15-1-252,15-1-253,15-1-254,15-1-256,15-1-257,15-1-258,15-1-26,15-1-260,15-1-261,15-1-262,15-1-263,15-1-264"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-265,15-1-266,15-1-268,15-1-269,15-1-27,15-1-270,15-1-271,15-1-272,15-1-273,15-1-274,15-1-275,15-1-276,15-1-277,15-1-278,15-1-279,15-1-28,15-1-280,15-1-281,15-1-282,15-1-283,15-1-284,15-1-286,15-1-287,15-1-288,15-1-289,15-1-29,15-1-290,15-1-291,15-1-292,15-1-293"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-294,15-1-296,15-1-297,15-1-298,15-1-299,15-1-3,15-1-30,15-1-300,15-1-301,15-1-302,15-1-303,15-1-304,15-1-305,15-1-306,15-1-307,15-1-308,15-1-31,15-1-310,15-1-313,15-1-316,15-1-317,15-1-319,15-1-32,15-1-320,15-1-321,15-1-322,15-1-323,15-1-324,15-1-325,15-1-326"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-327,15-1-33,15-1-336,15-1-337,15-1-338,15-1-339,15-1-34,15-1-342,15-1-344,15-1-346,15-1-347,15-1-348,15-1-349,15-1-35,15-1-350,15-1-352,15-1-353,15-1-354,15-1-355,15-1-356,15-1-357,15-1-358,15-1-359,15-1-36,15-1-360,15-1-361,15-1-362,15-1-363,15-1-364,15-1-365"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-366,15-1-367,15-1-368,15-1-369,15-1-37,15-1-370,15-1-371,15-1-375,15-1-377,15-1-378,15-1-379,15-1-380,15-1-381,15-1-382,15-1-383,15-1-384,15-1-386,15-1-387,15-1-389,15-1-39,15-1-390,15-1-391,15-1-392,15-1-393,15-1-394,15-1-395,15-1-396,15-1-397,15-1-398,15-1-4"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-40,15-1-400,15-1-401,15-1-402,15-1-403,15-1-404,15-1-405,15-1-406,15-1-407,15-1-408,15-1-409,15-1-41,15-1-410,15-1-411,15-1-412,15-1-413,15-1-414,15-1-415,15-1-416,15-1-417,15-1-418,15-1-42,15-1-420,15-1-421,15-1-422,15-1-423,15-1-424,15-1-425,15-1-426,15-1-427"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-428,15-1-429,15-1-43,15-1-430,15-1-431,15-1-432,15-1-433,15-1-434,15-1-435,15-1-436,15-1-437,15-1-438,15-1-439,15-1-44,15-1-440,15-1-441,15-1-442,15-1-443,15-1-444,15-1-445,15-1-446,15-1-447,15-1-448,15-1-449,15-1-45,15-1-450,15-1-451,15-1-452,15-1-453,15-1-454"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-455,15-1-456,15-1-457,15-1-459,15-1-46,15-1-460,15-1-461,15-1-463,15-1-464,15-1-465,15-1-466,15-1-467,15-1-468,15-1-469,15-1-47,15-1-470,15-1-471,15-1-473,15-1-474,15-1-475,15-1-477,15-1-478,15-1-479,15-1-48,15-1-480,15-1-481,15-1-482,15-1-483,15-1-484,15-1-485"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-486,15-1-487,15-1-488,15-1-489,15-1-49,15-1-490,15-1-491,15-1-492,15-1-493,15-1-494,15-1-495,15-1-497,15-1-498,15-1-499,15-1-5,15-1-50,15-1-500,15-1-5003,15-1-501,15-1-502,15-1-503,15-1-504,15-1-505,15-1-508,15-1-509,15-1-5095,15-1-51,15-1-510,15-1-511,15-1-5113"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-512,15-1-5124,15-1-5129,15-1-513,15-1-5133,15-1-5146,15-1-5148,15-1-516,15-1-5165,15-1-5170,15-1-5173,15-1-5179,15-1-518,15-1-5184,15-1-5189,15-1-519,15-1-5196,15-1-5197,15-1-5198,15-1-5199,15-1-52,15-1-520,15-1-5202,15-1-5209,15-1-5211,15-1-5213,15-1-5216,15-1-522,15-1-5221,15-1-523"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-5232,15-1-5236,15-1-5238,15-1-524,15-1-5241,15-1-5242,15-1-5243,15-1-5248,15-1-5249,15-1-525,15-1-5251,15-1-5252,15-1-5253,15-1-526,15-1-5267,15-1-527,15-1-5270,15-1-5271,15-1-5276,15-1-5278,15-1-528,15-1-5283,15-1-5287,15-1-5288,15-1-529,15-1-53,15-1-530,15-1-532,15-1-535,15-1-536"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-537,15-1-538,15-1-54,15-1-541,15-1-542,15-1-543,15-1-544,15-1-545,15-1-547,15-1-548,15-1-55,15-1-56,15-1-57,15-1-58,15-1-59,15-1-6,15-1-60,15-1-6022,15-1-6026,15-1-6027,15-1-6028,15-1-6031,15-1-6032,15-1-6039,15-1-6040,15-1-6043,15-1-6047,15-1-6051,15-1-61,15-1-62"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-63,15-1-64,15-1-65,15-1-66,15-1-67,15-1-68,15-1-69,15-1-7,15-1-70,15-1-71,15-1-73,15-1-74,15-1-75,15-1-76,15-1-77,15-1-78,15-1-79,15-1-8,15-1-80,15-1-800,15-1-8001,15-1-8002,15-1-8003,15-1-8004,15-1-8005,15-1-8006,15-1-8007,15-1-8008,15-1-8009,15-1-801"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=15-1-8010,15-1-8011,15-1-8012,15-1-8013,15-1-8014,15-1-8015,15-1-8016,15-1-802,15-1-803,15-1-804,15-1-806,15-1-81,15-1-82,15-1-83,15-1-84,15-1-85,15-1-87,15-1-88,15-1-89,15-1-9,15-1-90,15-1-91,15-1-92,15-1-93,15-1-94,15-1-96,15-1-98,15-1-99,16-1-1002,16-1-102"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=16-1-1102,16-1-1202,16-1-1302,16-1-1402,16-1-1502,16-1-202,16-1-2502,16-1-2702,16-1-2802,16-1-602,16-1-702,16-1-802,16-1-902,16-2-4104,16-2-4204,16-2-4604,16-2-4804,16-2-5204,16-2-5404,16-2-5504,16-2-5604,16-2-5704,16-2-5904,16-2-6004,17-1-242,17-1-36,17-1-4,17-1-70,18-1-1,18-1-10"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=18-1-2,18-1-3,18-1-4,18-1-5,18-1-6,18-1-7,18-1-8,18-1-9,19-1-00421,19-1-01317,19-1-01641,19-1-01702,19-1-02460,19-1-02626,19-1-02697,19-1-03228,2-1-004,2-1-006,2-1-007,2-1-008,2-1-009,2-1-010,2-1-011,2-1-012,2-1-013,2-1-014,2-1-015,2-1-016,2-1-017,2-1-018"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=2-1-019,2-1-021,2-1-022,2-1-023,2-1-024,2-1-025,2-1-031,2-1-032,2-1-033,2-1-035,2-1-036,2-1-037,2-1-038,2-1-042,2-1-043,2-1-044,2-1-045,2-1-046,2-1-047,2-1-048,2-1-050,2-1-051,2-1-053,2-1-055,2-1-056,2-1-057,2-1-058,2-1-067,2-1-068,2-1-069"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=2-1-072,2-1-074,2-1-075,2-1-076,2-1-084,2-1-085,2-1-089,2-1-090,2-1-091,2-1-092,2-1-096,2-1-097,2-1-100,2-1-101,2-1-102,2-1-103,2-1-104,2-1-105,2-1-109,2-1-114,2-1-117,2-1-118,2-1-119,2-1-122,2-1-124,2-1-125,2-1-127,2-1-131,2-1-134,2-1-138"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=2-1-141,2-1-143,2-1-145,2-1-147,2-1-148,2-1-149,2-1-150,2-1-151,2-1-152,2-1-153,2-1-156,2-1-159,2-1-160,2-1-161,2-1-162,2-1-163,2-1-164,2-1-165,2-1-166,2-1-167,2-1-168,2-1-171,2-1-172,2-1-173,2-1-175,2-1-177,2-1-179,2-1-181,2-1-182,2-1-183"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=2-1-184,2-1-185,2-1-186,2-1-187,2-1-188,2-1-189,2-1-192,2-1-195,2-1-196,2-1-197,2-1-198,2-1-199,2-1-200,2-1-201,2-1-202,2-1-203,2-1-204,2-1-205,2-1-206,2-1-207,2-1-208,2-1-211,2-1-212,2-1-213,2-1-214,2-1-215,2-1-216,2-1-217,2-1-218,2-1-221"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=2-1-257,2-1-259,2-1-260,2-1-263,2-1-264,2-1-265,2-1-266,2-1-351,2-2-225,2-2-226,2-2-228,2-2-229,2-2-230,2-2-232,2-2-233,2-2-234,2-2-235,2-2-236,2-2-237,2-2-238,2-2-239,2-2-240,2-2-241,2-2-242,2-2-243,2-3-246,2-3-247,2-3-248,20-1-1,21-1-1"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=21-1-10,21-1-11,21-1-13,21-1-14,21-1-15,21-1-16,21-1-17,21-1-18,21-1-19,21-1-2,21-1-20,21-1-21,21-1-22,21-1-23,21-1-24,21-1-26,21-1-27,21-1-28,21-1-3,21-1-33,21-1-34,21-1-4,21-1-5,21-1-6,21-1-7,21-1-8,21-1-9,23-1-6201,23-1-6203,23-1-6204"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=23-1-6205,23-1-6206,23-1-6208,23-1-6209,23-1-6210,23-1-6211,23-1-6212,23-1-6213,23-1-6214,23-1-6215,23-1-6216,23-1-6217,23-1-6218,23-1-6219,23-1-6220,23-1-6221,23-1-6222,23-1-6223,23-1-6224,23-1-6225,23-1-6226,23-1-6227,23-1-6228,23-1-6229,23-1-6230,23-1-6233,23-1-6235,23-1-6236,23-1-6237,23-1-6239"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=23-1-6243,23-1-6245,23-1-6247,23-1-6253,23-1-6255,23-1-6256,23-1-6257,23-1-6260,23-1-6262,23-1-6264,23-1-6265,23-1-6269,23-1-6271,23-1-6275,23-1-6276,23-1-6277,23-1-6278,23-1-6279,23-1-6280,23-1-6283,23-1-6284,23-1-6285,23-1-6286,23-1-6287,23-1-6288,23-1-6291,23-1-6292,23-1-6293,23-1-6294,24-1-194"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=24-1-197,24-1-202,24-1-205,24-1-218,24-1-219,24-1-229,24-1-230,24-1-231,24-1-232,24-1-238,24-1-240,24-1-241,24-1-244,24-1-245,24-1-246,24-1-249,24-1-252,24-1-255,24-1-257,24-1-258,24-1-260,24-1-261,24-1-263,24-1-270,24-1-273,24-1-275,24-1-280,24-1-282,24-1-283,24-1-284"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=24-1-287,24-1-288,24-1-290,24-1-292,24-1-294,24-1-317,24-1-324,25-1-1,29-1-1,29-1-2,29-1-3,29-1-4,29-1-5,29-1-6,29-1-7,29-1-8,3-1-1066,3-1-1068,3-1-1132,3-1-1157,3-1-1158,3-1-1230,3-1-1291,3-1-1344,3-1-1380,3-1-1389,3-1-1401,3-1-1425,3-1-1426,3-1-1428"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=3-1-1438,3-1-1439,3-1-1450,3-1-1469,3-1-1478,3-1-1482,3-1-1506,3-1-1507,3-1-1539,3-1-1553,3-1-1584,3-1-1606,3-1-1682,3-1-1695,3-1-1716,3-1-1717,3-1-1735,3-1-1736,3-1-2,3-1-29,3-1-3,3-1-31,3-1-36,3-1-46,3-1-56,3-1-584,3-1-599,3-1-62,3-1-631,3-1-65"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=3-1-66,35-1-1,36-3-25,36-3-26,36-3-32,36-4-51,36-5-73,36-6-40,4-1-289,44-1-1,44-1-2,44-1-7,44-1-8,45-1-5,46-1-3,47-1-1,47-1-2,47-1-3,49-1-2,5-1-1,5-1-2,5-1-3,5-1-4,5-1-5,5-1-6,50-1-2,6-1-1,6-1-10,6-1-11,6-1-12"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=6-1-14,6-1-16,6-1-17,6-1-18,6-1-19,6-1-2,6-1-20,6-1-22,6-1-23,6-1-24,6-1-25,6-1-26,6-1-3,6-1-4,6-1-5,6-1-6,6-1-7,6-1-8,6-1-9,6-2-1,6-2-2,6-2-21,65-1-328,65-1-337,65-1-341,7-1-12,7-1-13,7-1-14,7-1-2,7-1-20"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=7-1-22,7-1-26,7-1-29,7-1-3,7-1-31,7-1-32,7-1-33,7-1-34,7-1-35,7-1-37,7-1-39,7-1-40,7-1-41,7-1-42,7-1-43,7-1-44,7-1-45,7-1-46,7-1-47,7-1-48,7-1-5,7-1-50,7-1-53,7-1-7,7-1-8,7-2-801,7-2-802,7-2-803,7-2-804,7-2-805"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=7-2-806,7-2-807,7-2-808,8-1-1,8-1-2,8-1-3,8-1-4,8-1-5,8-1-6,8-1-7,8-1-8,8-1-9,9-1-10,9-1-110,9-1-113,9-1-114,9-1-119,9-1-122,9-1-125,9-1-127,9-1-13,9-1-134,9-1-140,9-1-150,9-1-153,9-1-155,9-1-158,9-1-159,9-1-160,9-1-162"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=9-1-164,9-1-165,9-1-170,9-1-171,9-1-172,9-1-173,9-1-174,9-1-175,9-1-176,9-1-179,9-1-180,9-1-181,9-1-182,9-1-183,9-1-184,9-1-185,9-1-187,9-1-188,9-1-189,9-1-19,9-1-190,9-1-191,9-1-192,9-1-193,9-1-194,9-1-195,9-1-196,9-1-20,9-1-220,9-1-232"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=9-1-234,9-1-24,9-1-240,9-1-241,9-1-242,9-1-243,9-1-32,9-1-36,9-1-398,9-1-399,9-1-40,9-1-400,9-1-401,9-1-402,9-1-408,9-1-410,9-1-413,9-1-414,9-1-415,9-1-417,9-1-423,9-1-430,9-1-432,9-1-433,9-1-434,9-1-437,9-1-440,9-1-453,9-1-455,9-1-464"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=9-1-466,9-1-472,9-1-473,9-1-475,9-1-476,9-1-478,9-1-479,9-1-485,9-1-503,9-1-505,9-1-51,9-1-52,9-1-544,9-1-545,9-1-546,9-1-548,9-1-550,9-1-551,9-1-56,9-1-584,9-1-6,9-1-631,9-1-633,9-1-636,9-1-638,9-1-64,9-1-640,9-1-645,9-1-646,9-1-655"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=9-1-656,9-1-657,9-1-658,9-1-659,9-1-660,9-1-665,9-1-668,9-1-669,9-1-674,9-1-677,9-1-685,9-1-686,9-1-688,9-1-690,9-1-691,9-1-692,9-1-696,9-1-697,9-1-698,9-1-70,9-1-700,9-1-702,9-1-703,9-1-704,9-1-705,9-1-706,9-1-708,9-1-71,9-1-711,9-1-72"},
{"Barrio":"Sin Definir", "Sucursales":"&array_sucursales=9-1-727,9-1-728,9-1-729,9-1-73,9-1-730,9-1-731,9-1-741,9-1-752,9-1-767,9-1-769,9-1-8,9-1-803,9-1-815,9-1-853,9-1-854,9-1-855,9-1-856,9-1-857,9-1-860,9-1-868,9-1-887,9-1-901,9-1-902,9-1-903,9-1-904,9-1-906,9-1-910,9-1-912,9-1-913,9-1-914"}

    ]

# %%
#Creamos una lista con las Productos y correspondientes
print("Obteniendo productos")
Productos = [

    {"Producto": "Yerba", "Marca": "Taragui", "id_producto": "7790387013627"},
    
    {"Producto": "Yerba", "Marca": "Mañanita", "id_producto": "7790387015324"},
    
    {"Producto": "Yerba", "Marca": "La merced", "id_producto": "7790387015607"},
    
    {"Producto": "Yerba", "Marca": "Playadito", "id_producto": "7793704000911"},
    
    {"Producto": "Yerba", "Marca": "Cruz de Malta", "id_producto": "7790070507389"},
    
    {"Producto": "Aceite", "Marca": "Cocinero", "id_producto": "7790070012050"},

    {"Producto": "Aceite", "Marca": "Cañuelas", "id_producto": "7792180001641"},
    
    {"Producto": "Aceite", "Marca": "Lira", "id_producto": "7790070231468"},
    
    {"Producto": "Harina", "Marca": "Morixe", "id_producto": "7790199000020"},
    
    {"Producto": "Harina", "Marca": "Favorita", "id_producto": "7790070507242"},
    
    {"Producto": "Harina", "Marca": "Caserita", "id_producto": "7792590000227"},
    
    ]

    
# %%
comienzourl="https://d3e6htiiul5ek9.cloudfront.net/prod/producto?limit=30&id_producto="
lista_url= list()
lista_barrios = list()
lista_productos = list()
lista_marcas = list()
for sucursal in Sucursales:
    for producto in Productos:
        url=comienzourl+producto["id_producto"]+sucursal["Sucursales"]
        lista_url.append(url)
        lista_barrios.append(sucursal["Barrio"])
        lista_productos.append(producto["Producto"])
        lista_marcas.append(producto["Marca"])


# %%
hoy = str(date.today())
headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.0.0 Safari/537.36'}

# %% Funcion para crear carpeta donde vamos a guardar los archivos
def crear_carpeta(path):
  #Vemos si existe la carpeta
  isExist = os.path.exists(path)
  
  #Si no existe la creamos
  if not isExist:
    os.makedirs(path)
    print("Nueva carpeta creada")
  else: print("La carpeta ya existe")
  #Creamos Ruta donde guardar archivos
  path_carpeta = path + "/"
  return path_carpeta
# %% LLamamos a la funcion creando una nueva carpeta con la fecha de hoy
path = r"C:/Test"+"/"+hoy
path_carpeta = crear_carpeta(path)
#path_carpeta = crear_carpeta()
# %%
i=0
for dato in lista_url:
    try:
      nombre_archivo = lista_productos[i]+"_"+lista_marcas[i]+"_"+lista_barrios[i]+"_"+hoy+"Nro"+str(i)+".json"
      path_archivo = path_carpeta + nombre_archivo #nuevo
      print("Creando archivo "+nombre_archivo)
      json_data = requests.get(lista_url[i], headers = headers).json()
      j = json.dumps(json_data)
      with open(path_archivo, 'w') as f:
        f.write(j)
        f.close()
        i=i+1
    except:pass

print("Proceso finalizado")
   # %%
